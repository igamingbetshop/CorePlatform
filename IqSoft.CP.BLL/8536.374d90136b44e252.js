"use strict";(self.webpackChunkAgentManagmentSystem=self.webpackChunkAgentManagmentSystem||[]).push([[8536],{516:(M,u,c)=>{c.d(u,{E:()=>f});var l=c(2116),h=c(7408),_=c(7672),o=(c(7024),c(5648));let f=(()=>{class p extends h.K{constructor(t){super(t),this.filterService=(0,l.uUt)(o.q),this.pagination=!0,this.paginationAutoPageSize=!1,this.paginationPageSize=100,this.cacheBlockSize=100,this.suppressPaginationPanel=!1,this.rowModelType=_.kt.SERVER_SIDE,this.serverSideStoreType="full",this.pageSizes=[100,500,1e3,2e3,5e3],this.defaultPageSize=100,this.paginationPage=1,this.defaultColDef={flex:1,editable:!1,filter:"agTextColumnFilter",resizable:!0,unSortIcon:!1,menuTabs:["filterMenuTab","generalMenuTab"],minWidth:15}}onFilterModified(t){this.colId=t.column.colId}keyPressHandler(t){if(document.querySelector(".ag-theme-balham .ag-popup")&&this.colId&&this.gridApi&&"13"===t.key){const i=this.gridApi.getFilterInstance(this.colId);this.colId=void 0,i&&i.applyModel(),this.gridApi.onFilterChanged(),this.gridApi.hidePopupMenu()}}onPaginationChanged(t){const n=this.gridApi?.paginationGetCurrentPage();isNaN(n)||(this.paginationPage=n+1)}onPaginationGoToPage(t){"Enter"===t.key&&(t.preventDefault(),this.gridApi?.paginationGoToPage(this.paginationPage-1))}setFilter(t,n){this.isEmpty(t)||Object.entries(t).forEach(([i,e])=>{const r=i+"s";if(n[r]={ApiOperationTypeList:[],IsAnd:this.getIsAnd(e.operator)},e.hasOwnProperty("condition1")&&e.condition1&&n[r].ApiOperationTypeList.push(this.mapFilterData(e.condition1)),e.hasOwnProperty("condition2")&&e.condition2)n[r].ApiOperationTypeList.push(this.mapFilterData(e.condition2));else{if(0===e.ApiOperationTypeList?.length)return;n[r].ApiOperationTypeList.push(this.mapFilterData(e))}})}mapFilterData(t){const n={OperationTypeId:t.type};switch(t.filterType){case"number":const i=parseFloat(t.filter);isNaN(i)||(n.DecimalValue=i,n.IntValue=Math.round(i));break;case"text":void 0!==t.filter&&(n.StringValue=t.filter);break;case"date":n.DateTimeValue=void 0!==t.dateFrom?t.dateFrom:new Date;break;case"boolean":void 0!==t.filter&&(n.BooleanValue=1===t.filter);break;case"set":n.OperationTypeId=11,void 0!==t.values&&(n.ArrayValue=t.values)}return console.log(n,"appendedFilter"),n}setFilterDropdown(t,n){const i=t.request.filterModel;for(const e of n)i[e]&&!i[e].filter&&(i[e].hasOwnProperty("condition1")?(i[e].condition1.filter=i[e].condition1.type,i[e].condition2.filter=i[e].condition2.type,i[e].condition1.type=1,i[e].condition2.type=1):(i[e].filter=i[e].type,i[e].type=1))}changeFilerName(t,n,i){for(let e=0;e<n.length;e++){const r=n[e];t[r]&&(t[i[e]]=t[r],delete t[r])}}static#e=this.\u0275fac=function(n){return new(n||p)(l.GI1(l.zZn))};static#t=this.\u0275dir=l.Sc5({type:p,standalone:!0,features:[l.eg9]})}return p})()},8536:(M,u,c)=>{c.r(u),c.d(u,{CommissionPlanComponent:()=>t});var l=c(1368),h=c(6692),_=c(516),O=c(4796),o=c(2116),f=c(748),p=c(8196);const D=["agGrid"];let t=(()=>{class n extends _.E{constructor(e,r,a){super(e),this.injector=e,this.snackbarService=r,this.localStorageService=a,this.components={numericEditor:O.K},this.isServerSideGroup=s=>s.group,this.getServerSideGroupKey=s=>s.Id,this.autoGroupColumnDef={headerName:"GroupId",field:"Id",checkboxSelection:!0,cellRendererParams:{innerRenderer:s=>s.data.Id}},this.createServerSideDatasource=()=>({getRows:s=>{const d={SkipCount:0,TakeCount:-1};-1==s.parentNode.level?d.ProductId=1:d.ParentId=s.parentNode.data.Id,this.setFilter(s.request.filterModel,d),this.mainService.getProducts(d).subscribe(P=>{if(0===P.ResponseCode){const m=P.ResponseObject;Array.isArray(m)?(m.forEach(g=>{g.group=!g.IsLeaf,this.mappedData.forEach(C=>{C.ProductId===g.Id?(g.TurnoverPercent=C.TurnoverPercent,g.Percent=C.Percent):(g.TurnoverPercent=null,g.Percent=null)})}),s.success({rowData:m,rowCount:m.length})):this.snackbarService.showError("Invalid data format: Entities is not an array")}else this.snackbarService.showError(P.Description)})}}),this.columnDefs=[{headerName:"Common.Id",field:"Id",hide:!0},{headerName:"Name",field:"Name",editable:!1},{headerName:"ParentId",field:"ParentId"},{headerName:"TurnoverPercent",field:"TurnoverPercent",editable:!1},{headerName:"Percent",field:"Percent",editable:!1},{headerName:"State",field:"State",cellRenderer:s=>0===s.data.State?"Inactive":1===s.data.State?"Active":""}]}ngOnInit(){this.getCommissionPlan(),this.genders=this.localStorageService.get("enums").genders}getCommissionPlan(){this.mainService.getCommissionPlan(null).subscribe(e=>{0===e.ResponseCode?this.mappedData=e.ResponseObject:this.snackbarService.showError(e.Description)})}onGridReady(e){this.gridApi=e.api,this.gridApi.setServerSideDatasource(this.createServerSideDatasource())}static#e=this.\u0275fac=function(r){return new(r||n)(o.GI1(o.zZn),o.GI1(f.i),o.GI1(p.s))};static#t=this.\u0275cmp=o.In1({type:n,selectors:[["app-commission-plan"]],viewQuery:function(r,a){if(1&r&&o.CC$(D,5),2&r){let s;o.wto(s=o.Gqi())&&(a.agGrid=s.first)}},standalone:!0,features:[o.eg9,o.UHJ],decls:7,vars:16,consts:[[1,"container"],[1,"content-action"],[1,"title"],[1,"grid-content"],[1,"ag-theme-balham",3,"headerHeight","rowHeight","rowData","enableGroupEdit","autoGroupColumnDef","rowModelType","columnDefs","defaultColDef","treeData","animateRows","components","cacheBlockSize","isServerSideGroup","getServerSideGroupKey","ensureDomOrder","enableCellTextSelection","gridReady"],["agGrid",""]],template:function(r,a){1&r&&(o.I0R(0,"div",0)(1,"div",1)(2,"div",2),o.OEk(3,"Products"),o.C$Y()(),o.I0R(4,"div",3)(5,"ag-grid-angular",4,5),o.qCj("gridReady",function(d){return a.onGridReady(d)}),o.C$Y()()()),2&r&&(o.yG2(5),o.E7m("headerHeight",a.headerHeight)("rowHeight",a.rowHeight)("rowData",a.rowData)("enableGroupEdit",!0)("autoGroupColumnDef",a.autoGroupColumnDef)("rowModelType",a.rowModelType)("columnDefs",a.columnDefs)("defaultColDef",a.defaultColDef)("treeData",!0)("animateRows",!0)("components",a.components)("cacheBlockSize",1e4)("isServerSideGroup",a.isServerSideGroup)("getServerSideGroupKey",a.getServerSideGroupKey)("ensureDomOrder",!0)("enableCellTextSelection",!0))},dependencies:[l.MD,h.Oc,h.U5],styles:[".container[_ngcontent-%COMP%]{width:100%;height:100%;padding:0 10px;box-sizing:border-box}.container[_ngcontent-%COMP%]   .content-action[_ngcontent-%COMP%]{height:6%;display:flex;align-items:center;flex-wrap:wrap}.container[_ngcontent-%COMP%]   .content-action[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:20px;letter-spacing:.04em;color:#076192;flex:1;padding-left:10px}.container[_ngcontent-%COMP%]   .content-action[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#076192}.container[_ngcontent-%COMP%]   .content-action[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#000}.container[_ngcontent-%COMP%]   .content-action[_ngcontent-%COMP%]   .mat-btn[_ngcontent-%COMP%]{margin-left:8px;background-color:#239dff;padding:10px;border:1px solid #239dff;min-width:104px;color:#fff;border-radius:4px;font-size:16px;font-weight:500}.container[_ngcontent-%COMP%]   .content-action[_ngcontent-%COMP%]   .mat-btn[_ngcontent-%COMP%]     .mat-button-wrapper{color:#fff!important}.container[_ngcontent-%COMP%]   .content-action[_ngcontent-%COMP%]   .mat-btn.disabled[_ngcontent-%COMP%]{color:#076192!important;background-color:#a0c4d8;pointer-events:none}.container[_ngcontent-%COMP%]   .content-action[_ngcontent-%COMP%]   .mat-btn.disabled[_ngcontent-%COMP%]     .mat-button-wrapper{color:#076192!important}.container[_ngcontent-%COMP%]   .content-action[_ngcontent-%COMP%]   .mat-btn[_ngcontent-%COMP%]:hover{cursor:pointer;border:1px solid #076192;background:linear-gradient(#076192,#258ecd 50%,#0573ba)}.container[_ngcontent-%COMP%]   .grid-content[_ngcontent-%COMP%]{width:100%;height:77vh}.container[_ngcontent-%COMP%]   .grid-content[_ngcontent-%COMP%]     ag-grid-angular{width:100%;height:100%}"]})}return n})()}}]);